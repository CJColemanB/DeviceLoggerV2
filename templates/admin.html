<!DOCTYPE html>

<html>
<head>
<!-- Use Tailwind CSS for better styling and responsive design -->
<script src="https://www.google.com/search?q=https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="/static/styles.css">
<script src="/static/admin.js"></script>
<title>Admin Panel</title>
</head>
<body class="bg-gray-50 p-6 min-h-screen font-sans">
<div class="max-w-4xl mx-auto bg-white p-8 rounded-xl shadow-2xl">
<h1 class="text-4xl font-extrabold text-gray-900 mb-6 border-b pb-4">Device Management Admin Panel</h1>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <div class="mb-4 p-4 bg-green-100 border-l-4 border-green-500 text-green-700 rounded-lg">
                {% for message in messages %}
                    <p>{{ message }}</p>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <!-- ADD DEVICE FORM -->
    <h2 class="text-2xl font-semibold text-gray-800 mt-8 mb-4">Add New Device</h2>
    <form method="post" class="space-y-4">
        
        <!-- Category Dropdown -->
        <label for="device_category" class="block text-sm font-medium text-gray-700">Device Category</label>
        <select name="category" id="device_category" required class="input-field">
            <option value="" disabled selected>-- Select Device Type --</option>
            <option value="Laptop">Laptop</option>
            <option value="Charger">Charger</option>
            <option value="iPad">iPad</option>
            <option value="Headphones">Headphones</option>
            <option value="Other">Other</option>
        </select>

        <!-- Rubric ID (Prefix generated by JS) -->
        <label for="rubric_id_input" class="block text-sm font-medium text-gray-700">Rubric ID (e.g., SHC-LQ-)</label>
        <input name="rubric_id" id="rubric_id_input" placeholder="Rubric ID Prefix (Auto-filled)" required class="input-field"><br>
        
        <!-- Suffix ID -->
        <label for="suffix_id_input" class="block text-sm font-medium text-gray-700">Suffix ID (e.g., 001)</label>
        <input name="suffix_id" id="suffix_id_input" placeholder="Suffix ID (e.g., 001)" required class="input-field">
        
        <button class="btn blue w-full" type="submit">Add Device</button>
    </form>

    <hr class="my-8">

    <!-- DEVICE LIST -->
    <h2 class="text-2xl font-semibold text-gray-800 mt-8 mb-4">Current Devices</h2>
    <div class="overflow-x-auto">
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Rubric</th>
                    <th>Suffix</th>
                    <th>Category</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for d in devices %}
                <tr>
                    <td>{{ d[0] }}</td>
                    <td>{{ d[1] }}</td>
                    <td>{{ d[2] }}</td>
                    <td>{{ d[3] }}</td>
                    <td>
                        {% if d[4] == 1 %}
                            <span class="px-2 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Loanable</span>
                        {% else %}
                            <span class="px-2 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">Loaned Out</span>
                        {% endif %}
                    </td>
                    <td>
                        <!-- Delete form posts to /admin, handled by Python logic -->
                        <form method="post" style="display:inline;">
                            <input type="hidden" name="delete_id" value="{{ d[0] }}">
                            <button class="btn red text-sm" type="submit" onclick="return confirm('Are you sure you want to delete device ID {{ d[0] }}?')">Delete</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <a href="{{ url_for('index') }}" class="mt-6 inline-block">
        <button class="btn blue">Back to Home</button>
    </a>
</div>

</body>
</html>