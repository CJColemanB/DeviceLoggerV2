
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
</head>
<body>
{% include 'navbar.html' %}
<div class="container mt-4">
    <h2>Admin Dashboard</h2>
    <div class="mb-3">
        <a href="{{ url_for('export_excel') }}" class="btn btn-success">Export Excel</a>
        <a href="{{ url_for('export_pdf') }}" class="btn btn-warning">Export PDF</a>
        <a href="{{ url_for('email_overdue') }}" class="btn btn-danger">Email All Overdue</a>
        <a href="{{ url_for('logout') }}" class="btn btn-secondary">Logout</a>
    </div>
    <table id="deviceTable" class="display table table-striped">
        <thead>
            <tr><th>ID</th><th>Name</th><th>Email</th><th>Device Code</th><th>Device Type</th><th>Date Taken</th></tr>
        </thead>
        <tbody>
            {% for row in data %}
            <tr class="{% if (datetime.utcnow() - datetime.strptime(row[5], '%Y-%m-%d %H:%M:%S')).days > 7 %}overdue{% endif %}">
                <td>{{ row[0] }}</td><td>{{ row[1] }}</td><td>{{ row[2] }}</td>
                <td>{{ row[3] }}</td><td>{{ row[4] }}</td><td>{{ row[5] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script>
$(document).ready(function() {
    $('#deviceTable').DataTable();
});
</script>
</body>
</html>
